
# this is the default agent config which is used if no other config is
# specified for an agent.  It contains the minimal set of settings required for
# a functional pilot agent, without any component redundency.

{

    # max number of updates to put into a db bulk
    "bulk_collection_size" :  1024,

    # max time period to collect db notifications into bulks (seconds)
    "bulk_collection_time" : 1.0,

    # time to sleep between database polls (seconds)
    "db_poll_sleeptime"    : 2.0,

    # agent_0 must always have target 'local' at this point
    # mode 'shared'   : local node is also used for CUs
    # mode 'reserved' : local node is reserved for the agent
    # FIXME: mode is unused
    "target" : "local",
    "mode"   : "shared",

    # Bridges usually run in the main agent
    #
    # Bridges can be configured to stall for a certain batch of messages,
    # releasing them then as bulks of a certain size.  Default for both
    # stall_hwm and batch_size is 1 (no stalling, no bulking).
    #
    "bridges" : {
        "agent_staging_input_queue"  : { "log_level" : "error",
                                         "stall_hwm" : 1,
                                         "bulk_size" : 1},
        "agent_scheduling_queue"     : { "log_level" : "error",
                                         "stall_hwm" : 1,
                                         "bulk_size" : 1},
        "agent_executing_queue"      : { "log_level" : "error",
                                         "stall_hwm" : 1,
                                         "bulk_size" : 1},
        "agent_staging_output_queue" : { "log_level" : "error",
                                         "stall_hwm" : 1,
                                         "bulk_size" : 1},

        "funcs_wrk_queue"            : { "log_level" : "debug",
                                         "stall_hwm" : 1,
                                         "bulk_size" : 0},
        "funcs_res_queue"            : { "log_level" : "debug",
                                         "stall_hwm" : 1,
                                         "bulk_size" : 0},

        "agent_unschedule_pubsub"    : { "log_level" : "error"},
        "agent_schedule_pubsub"      : { "log_level" : "error"},

        "control_pubsub"             : { "log_level" : "error"},
        "state_pubsub"               : { "log_level" : "error"},
        "log_pubsub"                 : { "log_level" : "error"}
    },

    "components" : {
        # the update worker must live in agent_0, since only that agent is
        # sure to have connectivity toward the DB.
        "UpdateWorker"                : {"count" : 1},
        "AgentStagingInputComponent"  : {"count" : 1},
        "AgentSchedulingComponent"    : {"count" : 1},
        "AgentExecutingComponent"     : {"count" : 1},
        "AgentStagingOutputComponent" : {"count" : 1}
    }
}

